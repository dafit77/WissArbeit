bivariate_stats<- function(data, var1, var2) {
  library(dplyr)
  library(gmodels)  # Für CrossTable
  library(DescTools) # Für den Phi-Koeffizienten
  
  # Kontingenztabelle
  cat("\nKontingenztabelle:\n")
  tbl <- table(data[[var1]], data[[var2]])
  print(tbl)
  
  # Relative Häufigkeiten
  cat("\nRelative Häufigkeiten (gesamt):\n")
  print(prop.table(tbl))
  
  cat("\nRelative Häufigkeiten (zeilenweise):\n")
  print(prop.table(tbl, margin = 1))
  
  cat("\nRelative Häufigkeiten (spaltenweise):\n")
  print(prop.table(tbl, margin = 2))
  
  # Phi-Koeffizient (nur für dichotome Variablen)
  if (length(unique(data[[var1]])) == 2 && length(unique(data[[var2]])) == 2) {
    cat("\nPhi-Koeffizient:\n")
    phi_value <- Phi(tbl)
    print(phi_value)
  } else {
    cat("\nPhi-Koeffizient nicht berechnet: Mindestens eine Variable hat mehr als zwei Kategorien.\n")
  }
}
